<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enhanced Code Reviewer</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.36.1/min/vs/loader.js"></script>
    <style>
        :root {
            --primary: #4F46E5;
            --primary-hover: #4338CA;
            --success: #10B981;
            --warning: #F59E0B;
            --error: #EF4444;
            --bg: #F9FAFB;
            --card: #FFFFFF;
            --text: #111827;
            --text-secondary: #6B7280;
            --border: #E5E7EB;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            line-height: 1.5;
            padding: 1rem;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 1.5rem;
            padding: 1rem 0;
            border-bottom: 1px solid var(--border);
        }

        h1 {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--text);
            margin-bottom: 0.5rem;
            background: linear-gradient(90deg, #4F46E5, #7C3AED);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .panel-container {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
            margin-top: 1.5rem;
        }

        @media (min-width: 1024px) {
            .panel-container {
                flex-direction: row;
            }
        }

        .panel {
            background: var(--card);
            border-radius: 12px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
            overflow: hidden;
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .panel-header {
            padding: 1rem 1.5rem;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .panel-title {
            font-size: 1.125rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 6px;
            padding: 0.5rem 1rem;
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn:hover {
            background: var(--primary-hover);
            transform: translateY(-1px);
        }

        .btn-outline {
            background: transparent;
            border: 1px solid var(--border);
            color: var(--text);
        }

        .btn-outline:hover {
            background: #f8f9fa;
        }

        .code-container {
            position: relative;
            height: 400px;
            overflow: hidden;
        }

        #editor {
            width: 100%;
            height: 100%;
            border: none;
            outline: none;
        }

        .editor-actions {
            display: flex;
            gap: 0.5rem;
        }

        .review-container {
            padding: 1.5rem;
            flex: 1;
            overflow-y: auto;
            background-color: #f9fafb;
        }
        
        .issues-list {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .loading {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 2rem;
            color: var(--text-secondary);
        }

        .loading-spinner {
            width: 2.5rem;
            height: 2.5rem;
            border: 3px solid rgba(0, 0, 0, 0.1);
            border-radius: 50%;
            border-top-color: var(--primary);
            animation: spin 1s ease-in-out infinite;
            margin-bottom: 1rem;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .issue {
            background: white;
            border-radius: 8px;
            padding: 1.25rem;
            margin-bottom: 1.25rem;
            border-left: 4px solid var(--border);
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
            transition: all 0.2s ease;
            border: 1px solid #e5e7eb;
        }
        
        .issue:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }

        .issue.error {
            border-left-color: var(--error);
        }

        .issue.warning {
            border-left-color: var(--warning);
        }

        .issue.info {
            border-left-color: var(--primary);
        }

        .issue-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
        }

        .issue-title {
            font-weight: 600;
            font-size: 1rem;
            color: #111827;
            margin-bottom: 0.5rem;
            line-height: 1.5;
        }

        .issue-line {
            font-size: 0.75rem;
            color: #4b5563;
            background: #f3f4f6;
            padding: 0.25rem 0.6rem;
            border-radius: 4px;
            font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace;
            font-weight: 500;
        }

        .severity {
            font-size: 0.7rem;
            font-weight: 700;
            padding: 0.2rem 0.6rem;
            border-radius: 9999px;
            margin-left: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .severity.error {
            background-color: #FEE2E2;
            color: #B91C1C;
        }

        .severity.warning {
            background-color: #FEF3C7;
            color: #92400E;
        }

        .severity.info {
            background-color: #E0F2FE;
            color: #0369A1;
        }

        .issue-suggestion {
            margin-top: 0.75rem;
            padding: 0.75rem;
            background: #f8fafc;
            border-radius: 6px;
            font-size: 0.9rem;
        }

        .suggestion-title {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-weight: 600;
            color: #1e40af;
            margin: 1rem 0 0.75rem 0;
            font-size: 0.875rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        
        .suggestion-title svg {
            width: 16px;
            height: 16px;
            color: #3b82f6;
        }

        .suggestion-content {
            background: #f8fafc;
            padding: 1rem;
            border-radius: 6px;
            font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace;
            font-size: 0.875rem;
            line-height: 1.5;
            white-space: pre-wrap;
            word-break: break-word;
            border: 1px solid #e2e8f0;
            margin-top: 0.75rem;
            position: relative;
            overflow: hidden;
        }
        
        .suggestion-content::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 8px;
            background: linear-gradient(90deg, #f0f9ff, #e0f2fe);
        }
        
        .suggestion-content pre {
            margin: 0;
            padding: 0;
            background: transparent;
        }
        
        .suggestion-content code {
            display: block;
            padding: 1rem 0 0 0;
            color: #1e40af;
            font-family: inherit;
            white-space: pre-wrap;
            line-height: 1.5;
        }

        .status-bar {
            padding: 0.5rem 1rem;
            background: #f8f9fa;
            border-top: 1px solid var(--border);
            font-size: 0.8rem;
            color: var(--text-secondary);
            display: flex;
            justify-content: space-between;
        }

        .status-dot {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #10B981;
            margin-right: 0.5rem;
        }

        .status-dot.warning {
            background: #F59E0B;
        }

        .status-dot.error {
            background: #EF4444;
        }

        .toast {
            position: fixed;
            bottom: 1.5rem;
            right: 1.5rem;
            background: #1F2937;
            color: white;
            padding: 0.75rem 1.25rem;
            border-radius: 6px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            display: flex;
            align-items: center;
            gap: 0.75rem;
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .toast.show {
            transform: translateY(0);
            opacity: 1;
        }

        .toast.success {
            background: #10B981;
        }

        .toast.error {
            background: #EF4444;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>AI Code Reviewer</h1>
            <p style="color: var(--text-secondary);">Get instant feedback on your code quality</p>
        </header>

        <div class="panel-container">
            <div class="panel" style="flex: 1.5;">
                <div class="panel-header">
                    <h2 class="panel-title">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <polyline points="16 18 22 12 16 6"></polyline>
                            <polyline points="8 6 2 12 8 18"></polyline>
                        </svg>
                        Code Editor
                    </h2>
                    <div class="editor-actions">
                        <button id="formatBtn" class="btn btn-outline" title="Format Code">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <polyline points="16 3 21 3 21 8"></polyline>
                                <line x1="4" y1="20" x2="21" y2="3"></line>
                                <polyline points="21 16 21 21 16 21"></polyline>
                                <line x1="15" y1="15" x2="21" y2="21"></line>
                                <line x1="4" y1="4" x2="9" y2="9"></line>
                            </svg>
                            Format
                        </button>
                        <button id="copyBtn" class="btn btn-outline" title="Copy to Clipboard">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                                <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                            </svg>
                            Copy
                        </button>
                    </div>
                </div>
                <div class="code-container">
                    <div id="editor"></div>
                </div>
                <div class="status-bar">
                    <div class="status-item">
                        <span>JavaScript</span>
                    </div>
                    <button id="analyzeBtn" class="btn" style="padding: 0.25rem 0.75rem; font-size: 0.8rem;">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                        </svg>
                        Analyze Code
                    </button>
                </div>
            </div>

            <div class="panel" style="flex: 1;">
                <div class="panel-header">
                    <h2 class="panel-title">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                            <polyline points="14 2 14 8 20 8"></polyline>
                            <line x1="16" y1="13" x2="8" y2="13"></line>
                            <line x1="16" y1="17" x2="8" y2="17"></line>
                            <polyline points="10 9 9 9 8 9"></polyline>
                        </svg>
                        Code Review
                    </h2>
                    <div class="flex items-center gap-2">
                        <span id="issueCount" class="text-sm text-gray-500">0 issues found</span>
                    </div>
                </div>
                <div class="review-container">
                    <div id="reviewResults" class="issues-list">
                        <div class="text-center py-8 text-gray-500">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 mx-auto mb-4 text-gray-300" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                            </svg>
                            <p>Click "Analyze Code" to review your code</p>
                        </div>
                    </div>
                </div>
                <div class="status-bar">
                    <div class="status-item">
                        <div class="status-dot success"></div>
                        <span>Ready</span>
                    </div>
                    <div class="status-item">
                        <span>No active issues</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="toast">
        <div class="toast-icon">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                <polyline points="22 4 12 14.01 9 11.01"></polyline>
            </svg>
        </div>
        <div class="toast-message">Operation completed successfully</div>
    </div>

    <script>
        // DOM Elements
        const analyzeBtn = document.getElementById('analyzeBtn');
        const copyBtn = document.getElementById('copyBtn');
        const formatBtn = document.getElementById('formatBtn');
        const reviewResults = document.getElementById('reviewResults');
        const issueCount = document.getElementById('issueCount');
        const toast = document.getElementById('toast');

        // Initialize Monaco Editor
        require.config({ 
            paths: { 
                'vs': 'https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.36.1/min/vs',
                'monaco': 'https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.36.1/min/vs/loader' 
            },
            'vs/nls': {
                availableLanguages: { '*': 'en' }
            }
        });
        
        let editor;
        
        // Disable analyze button until Monaco is loaded
        analyzeBtn.disabled = true;
        analyzeBtn.innerHTML = `
            <div class="loading-spinner" style="width: 16px; height: 16px; margin-right: 8px;"></div>
            Loading Editor...
        `;
        
        // Load Monaco Editor
        require(['vs/editor/editor.main'], function() {
            // Create editor instance
            editor = monaco.editor.create(document.getElementById('editor'), {
                value: `// Example JavaScript code
function calculateTotal(items) {
    let total = 0;
    
    for (let i = 0; i < items.length; i++) {
        total += items[i].price * items[i].quantity;
    }
    
    return total;
}

// Example usage
const cart = [
    { name: 'Laptop', price: 999.99, quantity: 1 },
    { name: 'Mouse', price: 24.99, quantity: 2 },
    { name: 'Keyboard', price: 49.99, quantity: 1 }
];

console.log('Total: $' + calculateTotal(cart).toFixed(2));`,
                language: 'javascript',
                theme: 'vs-light',
                automaticLayout: true,
                minimap: { enabled: false },
                fontSize: 14,
                lineNumbers: 'on',
                roundedSelection: false,
                scrollBeyondLastLine: false,
                readOnly: false,
                renderWhitespace: 'selection',
                tabSize: 2,
            });
        });

        // Show toast notification
        function showToast(message, type = 'success') {
            const toastElement = document.getElementById('toast');
            const toastMessage = toastElement.querySelector('.toast-message');
            
            // Set message and type
            toastMessage.textContent = message;
            
            // Remove all type classes and add the new one
            toastElement.className = 'toast';
            toastElement.classList.add(type);
            
            // Show the toast
            setTimeout(() => {
                toastElement.classList.add('show');
                
                // Hide after 3 seconds
                setTimeout(() => {
                    toastElement.classList.remove('show');
                }, 3000);
            }, 100);
        }

        // Sample issues data - Moved to global scope
        window.sampleIssues = [
            {
                id: 1,
                message: 'Consider adding input validation for the items parameter',
                line: 2,
                severity: 'warning',
                suggestion: '// Add input validation at the start of the function\nif (!Array.isArray(items)) {\n  throw new Error(\'Expected items to be an array\');\n}\n\n// Check each item has required properties\nitems.forEach((item, index) => {\n  if (typeof item !== \'object\' || item === null) {\n    throw new Error(`Item at index ${index} must be an object`);\n  }\n  if (typeof item.price !== \'number\' || isNaN(item.price)) {\n    throw new Error(`Item at index ${index} must have a valid price`);\n  }\n  if (typeof item.quantity !== \'number\' || !Number.isInteger(item.quantity) || item.quantity < 0) {\n    throw new Error(`Item at index ${index} must have a non-negative integer quantity`);\n  }\n});'            
            },
            {
                id: 2,
                message: 'Missing JSDoc documentation for the function',
                line: 2,
                severity: 'info',
                suggestion: '/**\n * Calculates the total price of all items in the cart\n * @param {Array<Object>} items - Array of items in the cart\n * @param {number} items[].price - Price of the item\n * @param {number} items[].quantity - Quantity of the item\n * @returns {number} Total price of all items\n */'            },
            {
                id: 3,
                message: 'Consider using Array.reduce() for cleaner code',
                line: 5,
                severity: 'suggestion',
                suggestion: '// More concise implementation using reduce\nreturn items.reduce((total, item) => {\n  return total + (item.price * item.quantity);\n}, 0);'            },
            {
                id: 4,
                message: 'Add error handling for edge cases',
                line: 5,
                severity: 'warning',
                suggestion: '// Add error handling for empty array\nif (items.length === 0) {\n  console.warn(\'calculateTotal called with empty items array\');\n  return 0;\n}\n\n// Handle potential floating point precision issues\nconst total = items.reduce((sum, item) => {\n  return sum + (item.price * item.quantity);\n}, 0);\n\n// Round to 2 decimal places to avoid floating point precision issues\nreturn Math.round(total * 100) / 100;'            }
        ];

        // Format the severity text
        function formatSeverity(severity) {
            const severityMap = {
                'error': { text: 'Error', class: 'error' },
                'warning': { text: 'Warning', class: 'warning' },
                'info': { text: 'Info', class: 'info' },
                'suggestion': { text: 'Suggestion', class: 'suggestion' }
            };
            return severityMap[severity] || { text: severity, class: 'info' };
        }

        // Generate HTML for issues
        function renderIssues(issues) {
            if (!issues || issues.length === 0) {
                return `
                    <div class="text-center py-12">
                        <div class="text-green-500 mb-4">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-16 w-16 mx-auto" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                        </div>
                        <h3 class="text-xl font-semibold text-gray-800 mb-2">No Issues Found!</h3>
                        <p class="text-gray-600">Your code looks clean and follows best practices.</p>
                    </div>
                `;
            }

            // Ensure we have the latest sample issues if none are passed
            const issuesToRender = issues.length > 0 ? issues : window.sampleIssues || [];
            
            // Force render sample issues if no issues are found
            if (issuesToRender.length === 0) {
                console.log('No issues found, using sample issues');
                issuesToRender.push(...window.sampleIssues);
            }

            console.log('Rendering issues:', issuesToRender);

            return `
                <div class="issues-list">
                    ${issuesToRender.map(issue => `
                        <div class="issue ${issue.severity}">
                            <div class="issue-header">
                                <h3 class="issue-title">
                                    ${issue.message || 'Code issue detected'}
                                    <span class="severity ${issue.severity || 'info'}">
                                        ${formatSeverity(issue.severity || 'info').text}
                                    </span>
                                </h3>
                                ${issue.line ? `<span class="issue-line">Line ${issue.line}</span>` : ''}
                            </div>
                            ${issue.suggestion ? `
                                <div class="suggestion">
                                    <div class="suggestion-title">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                            <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>
                                        </svg>
                                        Suggestion
                                    </div>
                                    <div class="suggestion-content">
                                        <pre><code>${escapeHtml(issue.suggestion || 'No suggestion available')}</code></pre>
                                    </div>
                                </div>
                            ` : ''}
                        </div>
                    `).join('')}
                </div>
            `;
        }

        // Helper function to escape HTML
        function escapeHtml(unsafe) {
            return unsafe
                .replace(/&/g, "&amp;")
                .replace(/</g, "&lt;")
                .replace(/>/g, "&gt;")
                .replace(/"/g, "&quot;")
                .replace(/'/g, "&#039;");
        }

        // Format code
        function formatCode() {
            try {
                if (!editor) return;
                
                const code = editor.getValue();
                // Simple formatting
                const formatted = code
                    .replace(/\s*\n\s*\n\s*\n/g, '\n\n')
                    .replace(/([;{}])\n(\s*[^\s}])/g, '$1\n\n$2')
                    .replace(/\s+$/gm, '')
                    .trim() + '\n';
                
                editor.setValue(formatted);
                showToast('Code formatted successfully');
            } catch (error) {
                console.error('Error formatting code:', error);
                showToast('Error formatting code', 'error');
            }
        }

        // Copy code to clipboard
        async function copyToClipboard() {
            try {
                await navigator.clipboard.writeText(editor.getValue());
                showToast('Code copied to clipboard');
            } catch (err) {
                console.error('Failed to copy text: ', err);
                showToast('Failed to copy code', 'error');
            }
        }

        // Analyze code
        function analyzeCode() {
            if (!editor) {
                console.error('Editor not initialized');
                showToast('Editor is not ready. Please try again.', 'error');
                return;
            }
            
            // Always use sample issues for now to ensure something is shown
            const issues = window.sampleIssues || [];
            
            // Clear any previous results
            reviewResults.innerHTML = '';
            
            // Show loading state briefly
            reviewResults.innerHTML = `
                <div class="loading">
                    <div class="loading-spinner"></div>
                    <p>Analyzing your code...</p>
                </div>
            `;
            
            // Simulate analysis delay
            setTimeout(() => {
                // Always render the sample issues
                reviewResults.innerHTML = renderIssues(issues);
                issueCount.textContent = `${issues.length} ${issues.length === 1 ? 'issue' : 'issues'} found`;
                showToast(`Found ${issues.length} ${issues.length === 1 ? 'issue' : 'issues'} in your code`, 'success');
            }, 800);
            
            // Show loading state
            reviewResults.innerHTML = `
                <div class="loading">
                    <div class="loading-spinner"></div>
                    <p>Analyzing your code...</p>
                </div>
            `;
            
            // Get current code from editor
            const code = editor.getValue();
            console.log('Analyzing code:', code.substring(0, 100) + (code.length > 100 ? '...' : ''));

            // Simulate API call delay
            setTimeout(() => {
                // Use window.sampleIssues to ensure we're accessing the global variable
                const issues = window.sampleIssues || [];
                console.log('Analysis complete. Found issues:', issues.length);
                
                // Render issues or show a message if none found
                if (issues.length > 0) {
                    reviewResults.innerHTML = renderIssues(issues);
                    issueCount.textContent = `${issues.length} ${issues.length === 1 ? 'issue' : 'issues'} found`;
                    showToast(`Found ${issues.length} ${issues.length === 1 ? 'issue' : 'issues'} in your code`, 'success');
                } else {
                    reviewResults.innerHTML = `
                        <div class="text-center py-8">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 mx-auto text-green-500 mb-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                            <h3 class="text-lg font-medium text-gray-900">No issues found!</h3>
                            <p class="text-gray-500 mt-1">Your code looks clean and follows best practices.</p>
                        </div>
                    `;
                    issueCount.textContent = 'No issues found';
                    showToast('No issues found in your code', 'success');
                }
                
                // Update status bar
                const statusBar = document.querySelector('.status-bar .status-dot');
                const statusText = document.querySelector('.status-bar .status-item:last-child span');
                
                if (statusBar) {
                    const hasErrors = issues.some(issue => issue.severity === 'error');
                    const hasWarnings = issues.some(issue => issue.severity === 'warning');
                    
                    if (hasErrors) {
                        statusBar.className = 'status-dot error';
                        statusBar.nextElementSibling.textContent = 'Issues found';
                    } else if (hasWarnings) {
                        statusBar.className = 'status-dot warning';
                        statusBar.nextElementSibling.textContent = 'Warnings found';
                    } else {
                        statusBar.className = 'status-dot success';
                        statusBar.nextElementSibling.textContent = 'No critical issues';
                    }
                }
                
                if (statusText) {
                    const errorCount = issues.filter(issue => issue.severity === 'error').length;
                    const warningCount = issues.filter(issue => issue.severity === 'warning').length;
                    const infoCount = issues.filter(issue => issue.severity === 'info').length;
                    
                    let statusTextArr = [];
                    if (errorCount > 0) statusTextArr.push(`${errorCount} error${errorCount > 1 ? 's' : ''}`);
                    if (warningCount > 0) statusTextArr.push(`${warningCount} warning${warningCount > 1 ? 's' : ''}`);
                    if (infoCount > 0) statusTextArr.push(`${infoCount} info`);
                    
                    statusText.textContent = statusTextArr.join(', ') || 'No issues';
                }
            }, 1000);
        }

        // Initialize the application
        function initializeApp() {
            // Set up event listeners
            analyzeBtn.addEventListener('click', analyzeCode);
            copyBtn.addEventListener('click', copyToClipboard);
            formatBtn.addEventListener('click', formatCode);

            // Handle window resize
            window.addEventListener('resize', () => {
                if (editor) {
                    editor.layout();
                }
            });
            
            // Enable the analyze button once everything is ready
            analyzeBtn.disabled = false;
            analyzeBtn.innerHTML = `
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                </svg>
                Analyze Code
            `;
            
            console.log('Application initialized successfully');
        }

        // Start the application after Monaco is loaded
        initializeApp();
    </script>
</body>
</html>
